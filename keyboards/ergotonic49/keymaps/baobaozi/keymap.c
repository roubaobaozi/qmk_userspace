#include QMK_KEYBOARD_H

#include "baobaozi.h"

/* Re-pass though to allow templates to be used */
#define LAYOUT_wrapper(...) LAYOUT(__VA_ARGS__)

const uint16_t PROGMEM keymaps[][MATRIX_ROWS][MATRIX_COLS] = {
    [_COLEMAK] = LAYOUT_wrapper(
                // ┌─ Extra ─┬─── Q ───┬─── W ───┬─── F ───┬─── P ───┬─── G ───┐                   ┌─── J ───┬─── L ───┬─── U ───┬─── Y ───┬─── ; ───┬─ Extra ─┬─ Extra ─┐
                    KC_TAB   ,_________________ROW_TOP_COLMK_L_________________,                    _________________ROW_TOP_COLMK_R_________________,KC_BSPC  ,KC_MINS  ,
                // ├─────────┼─────────┼─────────┼─────────┼─────────┼─────────┤                   ├─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┤
                    LTN(GRV) ,_________________ROW_MID_COLMK_L_________________,                    _________________ROW_MID_COLMK_R_________________,LTN(ENT) ,KC_EQL   ,
                // ├─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┬─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┘
                    OS(LSFT) ,_________________ROW_BOT_COLMK_L_________________,TGCUR    ,TGQWER   ,_________________ROW_BOT_COLMK_R_________________,OS(RSFT) ,
        // ┌───────┴─┬───────┴───────┬─┴───────┬─┴───────┬─┴───────┬─┴───────┬─┴─────────┴─────────┴┬────────┴┬────────┴┬────────┴┬────────┴┬────────┴─────────┘
            KC_BTN1  ,                __T_L4___,__T_L3___,__T_L2___,__T_L1___,TGNAV                 ,__T_R1___,__T_R2___,__T_R2B__,__T_R3___,
        // └─────────┘               └─────────┴─────────┴─────────┴─────────┴──────────────────────┴─────────┴─────────┴─────────┴─────────┘
        // First rotary,                                                    second rotary, third rotary
        KC_PMNS  ,KC_PPLS  ,                                          KC_WH_L  ,KC_WH_R  ,KC_VOLD  ,KC_VOLU
    ),

    [_QWERTY] = LAYOUT_wrapper(
                // ┌─ Extra ─┬─── Q ───┬─── W ───┬─── F ───┬─── P ───┬─── G ───┐                   ┌─── J ───┬─── L ───┬─── U ───┬─── Y ───┬─── ; ───┬─ Extra ─┬─ Extra ─┐
                    _______  ,_________________ROW_TOP_QWERT_L_________________,                    _________________ROW_TOP_QWERT_R_________________,_______  ,_______  ,
                // ├─────────┼─────────┼─────────┼─────────┼─────────┼─────────┤                   ├─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┤
                    _______  ,_________________ROW_MID_QWERT_L_________________,                    _________________ROW_MID_QWERT_R_________________,_______  ,_______  ,
                // ├─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┬─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┘
                    _______  ,_________________ROW_BOT_QWERT_L_________________,_______  ,_______  ,_________________ROW_BOT_QWERT_R_________________,_______  ,
        // ┌───────┴─┬───────┴───────┬─┴───────┬─┴───────┬─┴───────┬─┴───────┬─┴─────────┴─────────┴┬────────┴┬────────┴┬────────┴┬────────┴┬────────┴─────────┘
            _______  ,                _______  ,_______  ,_______  ,_______  ,_______               ,_______  ,_______  ,_______  ,_______  ,
        // └─────────┘               └─────────┴─────────┴─────────┴─────────┴──────────────────────┴─────────┴─────────┴─────────┴─────────┘
        // First rotary,                                                    second rotary, third rotary
        _______  ,_______  ,                                          _______  ,_______  ,_______  ,_______
    ),

    [_NAV] = LAYOUT_wrapper(
                // ┌─ Extra ─┬─── Q ───┬─── W ───┬─── F ───┬─── P ───┬─── G ───┐                   ┌─── J ───┬─── L ───┬─── U ───┬─── Y ───┬─── ; ───┬─ Extra ─┬─ Extra ─┐
                    _______  ,_________________ROW_TOP_NAV_L___________________,                    _________________ROW_TOP_NAV_R___________________,KC_DEL   ,_______  ,
                // ├─────────┼─────────┼─────────┼─────────┼─────────┼─────────┤                   ├─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┤
                    _______  ,_________________ROW_MID_NAV_L___________________,                    _________________ROW_MID_NAV_R___________________,_______  ,_______  ,
                // ├─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┬─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┘
                    _______  ,_________________ROW_BOT_NAV_L___________________,_______  ,_______  ,_________________ROW_BOT_NAV_R___________________,_______  ,
        // ┌───────┴─┬───────┴───────┬─┴───────┬─┴───────┬─┴───────┬─┴───────┬─┴─────────┴─────────┴┬────────┴┬────────┴┬────────┴┬────────┴┬────────┴─────────┘
            _______  ,                _______  ,_______  ,_______  ,_______  ,_______               ,_______  ,_______  ,_______  ,_______  ,
        // └─────────┘               └─────────┴─────────┴─────────┴─────────┴──────────────────────┴─────────┴─────────┴─────────┴─────────┘
        // First rotary,                                                    second rotary, third rotary
        _______  ,_______  ,                                          _______  ,_______  ,_______  ,_______
    ),

#if defined(TEST_SYN)
    [_SYN] = LAYOUT_wrapper(
                // ┌─ Extra ─┬─── Q ───┬─── W ───┬─── F ───┬─── P ───┬─── G ───┐                   ┌─── J ───┬─── L ───┬─── U ───┬─── Y ───┬─── ; ───┬─ Extra ─┬─ Extra ─┐
                    _______  ,_________________ROW_TOP_SYN_L___________________,                    _________________ROW_TOP_SYN_R___________________,_______  ,_______  ,
                // ├─────────┼─────────┼─────────┼─────────┼─────────┼─────────┤                   ├─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┤
                    _______  ,_________________ROW_MID_SYN_L___________________,                    _________________ROW_MID_SYN_R___________________,_______  ,_______  ,
                // ├─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┬─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┘
                    _______  ,_________________ROW_BOT_SYN_L___________________,_______  ,_______  ,_________________ROW_BOT_SYN_R___________________,_______  ,
        // ┌───────┴─┬───────┴───────┬─┴───────┬─┴───────┬─┴───────┬─┴───────┬─┴─────────┴─────────┴┬────────┴┬────────┴┬────────┴┬────────┴┬────────┴─────────┘
            _______  ,                _______  ,_______  ,_______  ,_______  ,_______               ,_______  ,_______  ,_______  ,_______  ,
        // └─────────┘               └─────────┴─────────┴─────────┴─────────┴──────────────────────┴─────────┴─────────┴─────────┴─────────┘
        // First rotary,                                                    second rotary, third rotary
        _______  ,_______  ,                                          _______  ,_______  ,_______  ,_______
    ),
#else
    [_SYM] = LAYOUT_wrapper(
                // ┌─ Extra ─┬─── Q ───┬─── W ───┬─── F ───┬─── P ───┬─── G ───┐                   ┌─── J ───┬─── L ───┬─── U ───┬─── Y ───┬─── ; ───┬─ Extra ─┬─ Extra ─┐
                    _______  ,_________________ROW_TOP_SYM_L___________________,                    _________________ROW_TOP_SYM_R___________________,_______  ,_______  ,
                // ├─────────┼─────────┼─────────┼─────────┼─────────┼─────────┤                   ├─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┤
                    _______  ,_________________ROW_MID_SYM_L___________________,                    _________________ROW_MID_SYM_R___________________,_______  ,_______  ,
                // ├─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┬─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┘
                    _______  ,_________________ROW_BOT_SYM_L___________________,_______  ,_______  ,_________________ROW_BOT_SYM_R___________________,_______  ,
        // ┌───────┴─┬───────┴───────┬─┴───────┬─┴───────┬─┴───────┬─┴───────┬─┴─────────┴─────────┴┬────────┴┬────────┴┬────────┴┬────────┴┬────────┴─────────┘
            _______  ,                _______  ,_______  ,_______  ,_______  ,_______               ,_______  ,_______  ,_______  ,_______  ,
        // └─────────┘               └─────────┴─────────┴─────────┴─────────┴──────────────────────┴─────────┴─────────┴─────────┴─────────┘
        // First rotary,                                                    second rotary, third rotary
        _______  ,_______  ,                                          _______  ,_______  ,_______  ,_______
    ),

    [_NUM] = LAYOUT_wrapper(
                // ┌─ Extra ─┬─── Q ───┬─── W ───┬─── F ───┬─── P ───┬─── G ───┐                   ┌─── J ───┬─── L ───┬─── U ───┬─── Y ───┬─── ; ───┬─ Extra ─┬─ Extra ─┐
                    _______  ,_________________ROW_TOP_NUM_L___________________,                    _________________ROW_TOP_NUM_R___________________,_______  ,_______  ,
                // ├─────────┼─────────┼─────────┼─────────┼─────────┼─────────┤                   ├─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┤
                    _______  ,_________________ROW_MID_NUM_L___________________,                    _________________ROW_MID_NUM_R___________________,_______  ,_______  ,
                // ├─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┬─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┘
                    _______  ,_________________ROW_BOT_NUM_L___________________,_______  ,_______  ,_________________ROW_BOT_NUM_R___________________,_______  ,
        // ┌───────┴─┬───────┴───────┬─┴───────┬─┴───────┬─┴───────┬─┴───────┬─┴─────────┴─────────┴┬────────┴┬────────┴┬────────┴┬────────┴┬────────┴─────────┘
            _______  ,                _______  ,_______  ,_______  ,_______  ,_______               ,_______  ,_______  ,_______  ,_______  ,
        // └─────────┘               └─────────┴─────────┴─────────┴─────────┴──────────────────────┴─────────┴─────────┴─────────┴─────────┘
        // First rotary,                                                    second rotary, third rotary
        _______  ,_______  ,                                          _______  ,_______  ,_______  ,_______
    ),
#endif

    [_CUR] = LAYOUT_wrapper(
                // ┌─ Extra ─┬─── Q ───┬─── W ───┬─── F ───┬─── P ───┬─── G ───┐                   ┌─── J ───┬─── L ───┬─── U ───┬─── Y ───┬─── ; ───┬─ Extra ─┬─ Extra ─┐
                    _______  ,_________________ROW_TOP_CUR_L___________________,                    _________________ROW_TOP_CUR_R___________________,_______  ,_______  ,
                // ├─────────┼─────────┼─────────┼─────────┼─────────┼─────────┤                   ├─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┤
                    _______  ,_________________ROW_MID_CUR_L___________________,                    _________________ROW_MID_CUR_R___________________,_______  ,_______  ,
                // ├─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┬─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┘
                    _______  ,_________________ROW_BOT_CUR_L___________________,_______  ,_______  ,_________________ROW_BOT_CUR_R___________________,_______  ,
        // ┌───────┴─┬───────┴───────┬─┴───────┬─┴───────┬─┴───────┬─┴───────┬─┴─────────┴─────────┴┬────────┴┬────────┴┬────────┴┬────────┴┬────────┴─────────┘
            _______  ,                _______  ,_______  ,_______  ,_______  ,_______               ,_______  ,_______  ,_______  ,_______  ,
        // └─────────┘               └─────────┴─────────┴─────────┴─────────┴──────────────────────┴─────────┴─────────┴─────────┴─────────┘
        // First rotary,                                                    second rotary, third rotary
        _______  ,_______  ,                                          _______  ,_______  ,_______  ,_______
    ),

    [_FNC] = LAYOUT_wrapper(
                // ┌─ Extra ─┬─── Q ───┬─── W ───┬─── F ───┬─── P ───┬─── G ───┐                   ┌─── J ───┬─── L ───┬─── U ───┬─── Y ───┬─── ; ───┬─ Extra ─┬─ Extra ─┐
                    _______  ,_________________ROW_TOP_FNC_L___________________,                    _________________ROW_TOP_FNC_R___________________,_______  ,_______  ,
                // ├─────────┼─────────┼─────────┼─────────┼─────────┼─────────┤                   ├─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┤
                    _______  ,_________________ROW_MID_FNC_L___________________,                    _________________ROW_MID_FNC_R___________________,_______  ,_______  ,
                // ├─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┬─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┘
                    _______  ,_________________ROW_BOT_FNC_L___________________,_______  ,_______  ,_________________ROW_BOT_FNC_R___________________,_______  ,
        // ┌───────┴─┬───────┴───────┬─┴───────┬─┴───────┬─┴───────┬─┴───────┬─┴─────────┴─────────┴┬────────┴┬────────┴┬────────┴┬────────┴┬────────┴─────────┘
            _______  ,                _______  ,_______  ,_______  ,_______  ,_______               ,_______  ,_______  ,_______  ,_______  ,
        // └─────────┘               └─────────┴─────────┴─────────┴─────────┴──────────────────────┴─────────┴─────────┴─────────┴─────────┘
        // First rotary,                                                    second rotary, third rotary
        _______  ,_______  ,                                          _______  ,_______  ,_______  ,_______
    ),

    [_KB] = LAYOUT_wrapper(
                // ┌─ Extra ─┬─── Q ───┬─── W ───┬─── F ───┬─── P ───┬─── G ───┐                   ┌─── J ───┬─── L ───┬─── U ───┬─── Y ───┬─── ; ───┬─ Extra ─┬─ Extra ─┐
                    _______  ,_________________ROW_TOP_KB_L____________________,                    _________________ROW_TOP_KB_R____________________,_______  ,_______  ,
                // ├─────────┼─────────┼─────────┼─────────┼─────────┼─────────┤                   ├─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┤
                    _______  ,_________________ROW_MID_KB_L____________________,                    _________________ROW_MID_KB_R____________________,_______  ,_______  ,
                // ├─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┬─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┘
                    _______  ,_________________ROW_BOT_KB_L____________________,_______  ,_______  ,_________________ROW_BOT_KB_R____________________,_______  ,
        // ┌───────┴─┬───────┴───────┬─┴───────┬─┴───────┬─┴───────┬─┴───────┬─┴─────────┴─────────┴┬────────┴┬────────┴┬────────┴┬────────┴┬────────┴─────────┘
            _______  ,                _______  ,_______  ,_______  ,_______  ,_______               ,_______  ,_______  ,_______  ,_______  ,
        // └─────────┘               └─────────┴─────────┴─────────┴─────────┴──────────────────────┴─────────┴─────────┴─────────┴─────────┘
        // First rotary,                                                    second rotary, third rotary
        _______  ,_______  ,                                          _______  ,_______  ,_______  ,_______
    ),
};

// bool process_record_user(uint16_t keycode, keyrecord_t *record) {
//       return true;
// }

#if defined(ENCODER_ENABLE)
// rotary matrix
const uint8_t rt_matrix[][3][2] = {
    {{3,1},{3,2}},
    {{0,6},{1,6}},
    {{0,7},{3,11}},
};

bool encoder_update_user(uint8_t index, bool clockwise) {
    keypos_t key;
    int      cw = 0;
    if (clockwise) cw = 1;
    key.row          = rt_matrix[index][cw][0];
    key.col          = rt_matrix[index][cw][1];
    uint8_t  layer   = layer_switch_get_layer(key);
    uint16_t keycode = keymap_key_to_keycode(layer, key);
    tap_code16(keycode);
    return false;
}
#endif

// bool led_update_user(led_t led_state) {
//     rgblight_set_layer_state(0, IS_HOST_LED_ON(USB_LED_NUM_LOCK));
//     rgblight_set_layer_state(1, IS_HOST_LED_ON(USB_LED_CAPS_LOCK));
//     rgblight_set_layer_state(2, IS_HOST_LED_ON(USB_LED_SCROLL_LOCK));

//     return true;
// }

// void keyboard_post_init_user(void) {
// #if defined(CONSOLE_ENABLE)
//     debug_enable = true;
//     debug_matrix = true;
// #endif
// }
